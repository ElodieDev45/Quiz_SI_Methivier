
<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>README â€“ ..</title>
    
<style>
    @import url('https://fonts.googleapis.com/css2?family=Segoe+UI:wght@400;600&display=swap');

    html {
        background: linear-gradient(135deg, #e0e7ff 0%, #fef6fb 100%);
    }

    body {
        font-family: 'Segoe UI', sans-serif;
        background-color: #ffffff;
        color: #222;
        padding: 50px;
        max-width: 1000px;
        margin: auto;
        line-height: 1.7;
        box-shadow: 0 0 30px rgba(0, 0, 0, 0.04);
        border-radius: 12px;
    }

    h1, h2, h3 {
        color: #2868c7;
        margin-top: 40px;
        border-bottom: 1px solid #e0e0e0;
        padding-bottom: 6px;
    }

    ul {
        margin-left: 24px;
    }

    a {
        color: #1a73e8;
        text-decoration: none;
    }

    a:hover {
        text-decoration: underline;
    }

    pre, code {
        background-color: #f3f5f9;
        border-radius: 6px;
        padding: 8px 12px;
        font-family: Consolas, monospace;
        font-size: 0.95em;
    }

    table {
        border-collapse: collapse;
        width: 100%;
        margin: 30px 0;
    }

    th, td {
        border: 1px solid #ccc;
        padding: 10px;
        text-align: left;
        font-size: 0.95em;
        background-color: #fafafa;
    }

    hr {
        border: none;
        border-top: 1px solid #ddd;
        margin: 40px 0;
    }

    img {
        vertical-align: middle;
        margin-right: 6px;
    }
</style>

</head>
<body>
<h1>ğŸ§  Projet : Questionnaire Informatique</h1>
<p><img alt="Made with Python" src="https://img.shields.io/badge/Made%20with-Python-3776AB?style=flat&amp;logo=python&amp;logoColor=white">
<img alt="Excel Powered" src="https://img.shields.io/badge/Data%20Source-Excel-217346?style=flat&amp;logo=microsoft-excel&amp;logoColor=white">
<img alt="Auto-Updating JSON" src="https://img.shields.io/badge/JSON%20Output-Auto--Updating-4B8BBE?style=flat&amp;logo=json&amp;logoColor=white">
<img alt="SCSS to CSS" src="https://img.shields.io/badge/Style-SCSSâ†’CSS-DD1B16?style=flat&amp;logo=sass&amp;logoColor=white"></p>
<p>Ce projet propose un systÃ¨me complet pour <strong>crÃ©er, modifier et suivre dynamiquement un questionnaire</strong> depuis un fichier Excel. Il surveille en temps rÃ©el les changements dans le tableur et gÃ©nÃ¨re automatiquement un fichier JSON contenant toutes les informations du quiz (titres, questions, rÃ©ponses).</p>
<hr>
<p><em>ğŸ”¹ Pour rÃ©pondre simplement au questionnaire :</em><br>
<em>Lancez le fichier <code>START.bat</code></em><br>
<strong><em>â†’ Le quiz sâ€™ouvrira directement dans votre navigateur</em></strong> <em>(il sâ€™agit de la page <code>projet.html</code>, rendue automatiquement par le serveur Flask (server.py).)</em></p>
<p><em>ğŸ”¹ Pour modifier le projet ou utiliser les scripts Python :</em><br>
<em>Ouvrez un terminal dans le dossier <code>systeme</code> et lancez <code>.\launch.ps1</code></em><br>
<em>â†’ Cela activera lâ€™environnement virtuel <code>.venv</code>, nÃ©cessaire Ã  vos modifications</em></p>
<hr>
<h2>ğŸ“‘ Sommaire</h2>
<ul>
<li><a href="#objectifs">Objectifs</a></li>
<li><a href="#technologies-utilisees">Technologies utilisÃ©es</a></li>
<li><a href="#structure-du-projet">Structure du projet</a></li>
<li><a href="#installation">Installation</a></li>
<li><a href="#compilation-des-styles-scss">Compilation des styles (SCSS)</a></li>
<li><a href="#architecture-javascript-modulaire">Architecture JavaScript Modulaire</a></li>
<li><a href="#utilisation">Utilisation</a></li>
<li><a href="#notes-complementaires">Notes complÃ©mentaires</a></li>
<li><a href="#structureformats-des-fichiers-de-donnees">Structure/Formats des fichiers de donnÃ©es</a></li>
</ul>
<hr>
<p><a name="objectifs"></a></p>
<h2>ğŸ” Objectifs</h2>
<ul>
<li>âœï¸ <strong>Concevoir un questionnaire sur Excel</strong> (modifiable Ã  volontÃ©)</li>
<li>ğŸ”„ <strong>Surveiller automatiquement</strong> les modifications du fichier</li>
<li>ğŸ’¾ <strong>GÃ©nÃ©rer et mettre Ã  jour les fichiers JSON</strong> structurÃ©s contenant :</li>
<li>le titre du questionnaire</li>
<li>le descriptif du questionnaire</li>
<li>les questions</li>
<li>les rÃ©ponses proposÃ©es</li>
<li>les rÃ©ponses correctes permettant l'affichage des rÃ©sultats sous forme de pourcentage de rÃ©ussite.</li>
</ul>
<hr>
<p><a name="technologies-utilisees"></a></p>
<h2>ğŸ› ï¸ Technologies utilisÃ©es</h2>
<h3>ğŸ Python (.venv)</h3>
<h4>UtilisÃ© pour :</h4>
<ul>
<li>Lire le fichier Excel (<code>openpyxl</code>, <code>pandas</code>)</li>
<li>Surveiller les modifications (<code>watchdog</code>)</li>
<li>Convertir en JSON structurÃ©</li>
</ul>
<h4>Modules requis (<code>requirements.txt</code>) :</h4>
<ul>
<li><code>et_xmlfile</code>==2.0.0</li>
<li><code>Markdown</code>==3.8.2</li>
<li><code>numpy</code>==2.3.2</li>
<li><code>openpyxl</code>==3.1.5</li>
<li><code>pandas</code>==2.3.1</li>
<li><code>python-dateutil</code>==2.9.0.post0</li>
<li><code>pytz</code>==2025.2</li>
<li><code>six</code>==1.17.0</li>
<li><code>tzdata</code>==2025.2</li>
<li><code>watchdog</code>==6.0.0</li>
</ul>
<h3>ğŸŒ Node.js</h3>
<h4>UtilisÃ© pour :</h4>
<ul>
<li>Compiler les styles du projet en CSS</li>
</ul>
<h4>Packages utilisÃ©s (<code>package.json</code>) :</h4>
<ul>
<li><code>sass@1.89.2</code> â†’ SCSS â†’ CSS</li>
<li><code>g@2.0.1</code> â†’ Outils CLI</li>
</ul>
<hr>
<p><a name="structure-du-projet"></a></p>
<h2>ğŸ“ Structure du projet</h2>
<pre><code class="language-text">
&quot;nom du dossier&quot;/
â”œâ”€â”€ README.md                           # Documentation principale
â”œâ”€â”€ README.html                         # Version web du README, consultable hors GitHub
â”œâ”€â”€ START.bat                           # Script de lancement du quiz (windows)

â””â”€â”€ systeme/                            # Dossier contenant tous les composants du projet

    # ğŸš€ Lancement
    â”œâ”€â”€ launch.ps1                      # Script PowerShell de lancement (Windows)
    â”œâ”€â”€ script_lancement.py             # Script Python de lancement personnalisÃ©

    # ğŸ“¦ DÃ©pendances
    â”œâ”€â”€ requirements.txt                # DÃ©pendances Python nÃ©cessaires au projet
    â”œâ”€â”€ package.json                    # DÃ©pendances et configuration Node.js
    â”œâ”€â”€ package-lock.json               # Verrouillage des versions de modules

    # ğŸ¨ Interface utilisateur
    â”œâ”€â”€ projet.html                     # Page HTML affichÃ©e dans le navigateur par le serveur Flask

    # âš™ï¸ DonnÃ©es &amp; Configuration
    â”œâ”€â”€ config.json                     # Fichier JSON de configuration globale (en-tÃªte)
    â”œâ”€â”€ questions.json                  # Fichier JSON contenant les questions du quiz
    â”œâ”€â”€ Tableau-Questions.xlsx          # Tableur Excel contenant toutes les questions et calculs d'en-tÃªte

    # ğŸ”Œ Serveur
    â”œâ”€â”€ server.py                       # Serveur web Flask (gÃ¨re les requÃªtes et l'affichage)

    # ğŸ¨ Ressources front-end
    â”œâ”€â”€ css/                            # Fichiers style CSS compilÃ©s avec SASS
    â”œâ”€â”€ js/                             # Logique modulaire JavaScript pour lâ€™interactivitÃ© du Quiz
    â”œâ”€â”€ images/                         # Ressources graphiques utilisÃ©es dans le quiz

    # ğŸ§ª Environnements &amp; modules
    â”œâ”€â”€ .venv/                          # Environnement virtuel Python (isole les dÃ©pendance)
    â”œâ”€â”€ node_modules/                   # Modules Node.js installÃ©s automatiquement

    # ğŸ­ Personnalisation &amp; effets
    â”œâ”€â”€ Python/                         # Scripts de gÃ©nÃ©ration, conversion et surveillance
                                        (âš ï¸ pour `readme-en-html.py` version phyton 3.11.4 pour 
                                        pouvoir gÃ©nÃ©rer le fichier README.html)

    # ğŸ›  Utilitaires &amp; scripts annexes
    â”œâ”€â”€ pack-emoji-surveillance/        # Pack dâ€™emojis pour les scores et effets visuels


</code></pre>
<hr>
<p><a name="installation"></a></p>
<h2>âš™ï¸ Installation</h2>
<h3>ğŸ§¨ DÃ©marrage rapide avec <code>START.bat</code></h3>
<p>Le fichier <code>START.bat</code> est un script Windows permettant de lancer automatiquement tous les Ã©lÃ©ments nÃ©cessaires au fonctionnement du questionnaire.</p>
<pre><code class="language-console">
@echo off
start &quot;&quot; python\auto_convert.py
start &quot;&quot; python\server.py
start &quot;&quot; &quot;http://localhost:5000&quot;

</code></pre>
<ul>
<li>
<h5>ğŸ“Œ Il fait trois choses :</h5>
<ul>
<li>Lance la surveillance du fichier Excel pour gÃ©nÃ©rer le JSON (via <code>auto_convert.py</code>)</li>
<li>DÃ©marre le serveur Flask (<code>server.py</code>)</li>
<li>Ouvre automatiquement lâ€™interface du questionnaire dans le navigateur</li>
</ul>
</li>
<li>
<h5>âš ï¸ <em>Assurez-vous que :</em></h5>
<ul>
<li><em>Lâ€™environnement Python est bien configurÃ© (voir ci-dessous)</em></li>
<li><em>Les modules requis sont installÃ©s</em></li>
<li><em>Le projet est lancÃ© depuis le bon rÃ©pertoire</em></li>
</ul>
</li>
</ul>
<h3>ğŸ Python</h3>
<ul>
<li>
<p>ğŸ¯ <strong>Le script <code>launch.ps1</code></strong> permet d'activer automatiquement lâ€™environnement virtuel <code>.venv</code> et la surveillance du fichier Excel </p>
<p><em>(Ouvrir un terminal PowerShell dans le dossier <code>systeme</code>, puis lancer <code>.\launch.ps1</code>)</em></p>
<blockquote>
<p><em>Vous nâ€™avez donc pas besoin dâ€™entrer manuellement les commandes dâ€™installation â€” tout est gÃ©rÃ© en une seule Ã©tape.</em></p>
</blockquote>
</li>
<li>
<p>âš ï¸ <strong>Si vous configurez le projet pour la premiÃ¨re fois</strong>, voici les commandes PowerShell Ã  lancer pour initialiser lâ€™environnement virtuel :</p>
</li>
</ul>
<pre><code class="language-powershell">
python -m venv .venv
&amp; .venv\Scripts\Activate.ps1
pip install -r requirements.txt

</code></pre>
<blockquote>
<p>Une fois ces Ã©tapes rÃ©alisÃ©es, il suffit de lancer <code>launch.ps1</code> pour activer <code>.venv</code> et dÃ©marrer automatiquement la surveillance du fichier.</p>
</blockquote>
<h3>ğŸŒ Node.js</h3>
<pre><code class="language-node">
    npm install

</code></pre>
<hr>
<p><a name="compilation-des-styles-scss"></a></p>
<h2>ğŸ¨ Compilation des styles (SCSS)</h2>
<pre><code class="language-scss">
    sass style.scss style.css
    sass --watch style.scss style.css  # Pour compiler automatiquement

</code></pre>
<hr>
<p><a name="architecture-javascript-modulaire"></a></p>
<h2>ğŸ§  Architecture JavaScript Modulaire</h2>
<p>Le fichier principal <strong><em><code>main.js</code></em></strong> agit comme point d'entrÃ©e principal de l'application. 
Il orchestre :</p>
<ul>
<li><em>le chargement des donnÃ©es</em></li>
<li><em>l'affichage du quiz</em></li>
<li><em>la navigation entre les questions</em></li>
<li><em>la gestion des rÃ©sultats.</em></li>
</ul>
<p>Le projet adopte une approche <em>modulaire</em> avec une sÃ©paration claire des responsabilitÃ©s dans 4 fichiers js dits <strong><em>"modules"</em></strong>:</p>
<ul>
<li><code>donnees.js</code> : chargement et gestion des questions et mÃ©tadonnÃ©es</li>
<li><code>affichage.js</code> : affichage dynamique des questions, options, progression</li>
<li><code>navigation.js</code> : gestion du dÃ©placement entre les questions</li>
<li><code>resultats.js</code> : calcul et affichage des scores et recommandations</li>
</ul>
<p>Cette structure rend le code plus lisible, maintenable et Ã©volutif.</p>
<hr>
<p><a name="utilisation"></a></p>
<h2>ğŸ¯ Utilisation</h2>
<p>1- CrÃ©er/modifier le questionnaire dans Tableau-Questions.xlsx</p>
<p>2- Lancer le script de surveillance (prÃ©sent dans le dossier "py"):</p>
<pre><code class="language-python">
    auto_convert.py

</code></pre>
<p>Le fichier questions.json sera mis Ã  jour automatiquement Ã  chaque modification du fichier Excel.</p>
<hr>
<p><a name="notes-complementaires"></a></p>
<h2>âœ¨ Notes complÃ©mentaires</h2>
<ul>
<li>Le projet permet une adaptation rapide Ã  tout sujet ou thÃ¨me.</li>
<li>Aucune dÃ©pendance inutile : environnement Python et Node.js propre et Ã  jour.</li>
<li>Lâ€™environnement est auditÃ© sans vulnÃ©rabilitÃ©s.</li>
</ul>
<hr>
<p><a name="structureformats-des-fichiers-de-donnees"></a></p>
<h2>â• Structure et Formats des fichiers de donnÃ©es :</h2>
<p><strong>Deux</strong> fichiers JSON sont <strong>crÃ©Ã©s et mis Ã  jour</strong>, d'aprÃ¨s un tableur Excel, <strong>automatiquement</strong> et <strong>en mÃªme temps</strong>, <strong><em>sans aucune intervention manuelle</em></strong>, garantissant une parfaite synchronisation entre la source Excel et lâ€™affichage du quiz.</p>
<hr>
<h3><em>â•â•</em> Relatifs Ã  l'intÃ©gration des Titres</h3>
<hr>
<h4>ğŸŒ€ GÃ©nÃ©ration automatique : <code>config.json</code></h4>
<p>Le projet utilise un mÃ©canisme intelligent pour gÃ©nÃ©rer automatiquement le fichier <em><code>config.json</code></em> Ã  chaque mise Ã  jour du fichier Excelâ€¯<em><code>Tableau-Questions.xlsx</code></em> :</p>
<ul>
<li>
<p>Suivant l'onglet <strong><code>Infos</code></strong> dans le classeur excel qui contient un tableau permettant :</p>
<ul>
<li>
<p>de rÃ©cupÃ©rer <strong>dynamiquement</strong> le nom du dossier racine via une formule, en remontant dâ€™un ou plusieurs niveaux au choix depuis le dossier <code>systeme</code></p>
</li>
<li>
<p>de saisir <strong>manuellement</strong> un descriptif personnalisÃ© du questionnaire</p>
</li>
</ul>
</li>
</ul>
<h4>ğŸ’¡ UtilitÃ© de <code>config.json</code>:</h4>
<ul>
<li>
<p>Il sert Ã  alimenter le fichier <code>projet.html</code>pour :</p>
<ul>
<li>
<p>la balise <code>title</code> dans le <code>head</code> de <code>projet.html</code></p>
</li>
<li>
<p>le contenu de <code>h1</code> et <code>p</code> dans le bloc <code>.header</code></p>
</li>
</ul>
</li>
</ul>
<h4>ğŸ§® Structure EXCEL : <code>Tableau-Questions.xlsx</code> onglet <code>Infos</code></h4>
<ul>
<li><em>exemple de contenu</em></li>
</ul>
<pre><code class="language-text">
| nÂ° dossier parents recherchÃ© en  remontant le chemin | Titre-principal | Description-projet |
|------------------------------------------------------|-----------------|--------------------|
| 2                                                    | Quiz SI Metiv...| Ce quiz a Ã©tÃ©...   |

</code></pre>
<h4>ğŸª™ Structure JSON : <code>config.json</code></h4>
<ul>
<li><em>avec exemple du contenu</em></li>
</ul>
<pre><code class="language-json">
{
  &quot;titre-principal&quot;: &quot;Quiz SI Metiv...&quot;,
  &quot;description-projet&quot;: &quot;Ce quiz a Ã©tÃ©...&quot;
}

</code></pre>
<hr>
<h3><em>â•â•</em> Relatifs Ã  l'intÃ©gration des Questions</h3>
<hr>
<h4>ğŸŒ€ GÃ©nÃ©ration automatique : <code>questions.json</code></h4>
<p>Comme prÃ©cÃ©dement le projet utilise un mÃ©canisme intelligent pour gÃ©nÃ©rer automatiquement le fichier <code>questions.json</code> Ã  chaque mise Ã  jour du fichier Excelâ€¯<em><code>Tableau-Questions.xlsx</code></em>â€¯:</p>
<ul>
<li>
<p>Suivant l'onglet <strong><code>Questions</code></strong> dans le classeur excel qui contient un tableau permettant :</p>
<ul>
<li>
<p>de <strong>structurer</strong> le fichier JSON suivant les diffÃ©rentes <em>colonnes</em> du tableau</p>
</li>
<li>
<p>de <strong>saisir manuellement l'intÃ©gralitÃ©</strong> des donnÃ©es du questionnaire d'aprÃ¨s tout thÃ¨me dÃ©sirÃ©</p>
</li>
<li>
<p>de <strong>rÃ©cupÃ©rer dynamiquement</strong> l'intÃ©gralitÃ© des questions contenues dans le tableau</p>
</li>
</ul>
</li>
</ul>
<h4>ğŸ’¡ UtilitÃ© de <code>question.json</code>:</h4>
<ul>
<li>
<p>Il sert Ã  alimenter le fichier <code>projet.html</code>pour :</p>
<ul>
<li>
<p>la <strong>gÃ©nÃ©ration dynamique du contenu principal du quiz</strong>, incluant les questions, les options de rÃ©ponse et les catÃ©gories.</p>
</li>
<li>
<p>lâ€™<strong>affichage de chaque question et ses rÃ©ponses</strong> dans lâ€™interface interactive du quiz, en fonction de la progression utilisateur.</p>
</li>
<li>
<p>la <strong>logique de navigation et de vÃ©rification des rÃ©ponses</strong>, en associant chaque choix Ã  lâ€™identifiant correct provenant du JSON.</p>
</li>
<li>
<p><strong>la personnalisation visuelle et thÃ©matique</strong> du questionnaire, selon les mÃ©tadonnÃ©es prÃ©sentes dans chaque entrÃ©e (category, id, etc.)</p>
</li>
</ul>
</li>
</ul>
<h4>ğŸ§® Structure EXCEL : <code>Tableau-Questions.xlsx</code> onglet <code>Questions</code></h4>
<ul>
<li>colonnes de titres :</li>
</ul>
<pre><code class="language-text">
    &quot;id&quot;    &quot;category&quot;  &quot;question&quot;  &quot;a&quot; &quot;b&quot; &quot;c&quot; &quot;d&quot; &quot;correctAnswer&quot;

</code></pre>
<blockquote>
<p><strong>ğŸ“Œ Consignes</strong> :</p>
<blockquote>
<ul>
<li>
<p>les donnÃ©es de la colonne "id" doivent Ãªtre unique et correspondre au format : "q" + nÂ° question (ex : q1)</p>
</li>
<li>
<p>Les colonnes de rÃ©ponses ("a", "b", "c", ...) sont modulables Ã  volontÃ© (ajout ou suppression). Il suffit de suivre lâ€™ordre alphabÃ©tique avec un seul caractÃ¨re pour chaque titre.
Ces colonnes deviennent un objet <code>options</code> dans le fichier JSON gÃ©nÃ©rÃ©.</p>
</li>
<li>les autres colonnes sont FIXES et OBLIGATOIRES. Leur titres ne doivent PAS Ãªtre modifiÃ©s.</li>
</ul>
</blockquote>
</blockquote>
<h4>ğŸª™ Structure JSON : <code>question.json</code></h4>
<pre><code class="language-json">
    {
        &quot;id&quot;: &quot;&quot;,
        &quot;category&quot;: &quot;&quot;,
        &quot;question&quot;: &quot;&quot;,
        &quot;options&quot;: {
            &quot;a&quot;: &quot;&quot;,
            &quot;b&quot;: &quot;&quot;,
            &quot;c&quot;: &quot;&quot;,
            ...
        },
        &quot;correctAnswer&quot;: &quot;&quot;
    }

</code></pre>
<h4>ğŸ” Exemple Correspondance Excel/JSON :</h4>
<ul>
<li>
<h5>âœ… Excel</h5>
</li>
</ul>
<pre><code class="language-text">
| id | category | question                 | a    | b     | c      | correctAnswer |
|----|----------|--------------------------------------|------|-------|--------|---|
| q1 | gÃ©o      | Quelle est la capitale de lâ€™Italie ? | Rome | Milan | Naples | a |

</code></pre>
<ul>
<li>
<h5>âœ… JSON</h5>
</li>
</ul>
<pre><code class="language-json">
    {
    &quot;id&quot;: &quot;q1&quot;,
    &quot;category&quot;: &quot;gÃ©o&quot;,
    &quot;question&quot;: &quot;Quelle est la capitale de lâ€™Italie ?&quot;,
    &quot;options&quot;: {
        &quot;a&quot;: &quot;Rome&quot;,
        &quot;b&quot;: &quot;Milan&quot;,
        &quot;c&quot;: &quot;Naples&quot;
    },
    &quot;correctAnswer&quot;: &quot;a&quot;
    }

</code></pre>
</body>
</html>
